<table mat-table [dataSource]="dataSource" matSort [trackBy]="identity">
  <!-- person -->
  <ng-container matColumnDef="person">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden sm:table-cell">Person</th>
    <td mat-cell *matCellDef="let row">
      <div class="grid">
        <span class="text-wt-gray-dark">{{ row.reportingName }}</span>
        <div class="flex flex-row gap-2">
          <span class="hidden xs:block">{{ row.typeOfOwner }}</span>
          <span class="xs:max-sm:block">|</span>
          <span class="block sm:hidden">{{ row.transactionDate | date: 'MMMM d, y' }}</span>
        </div>
      </div>
    </td>
  </ng-container>

  <!-- security -->
  <ng-container matColumnDef="securityName">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden xl:table-cell">Security</th>
    <td mat-cell *matCellDef="let row" class="hidden xl:table-cell">
      <div class="space-x-2">
        <span>{{ row.securityName }}</span>
        <span>({{ row.acquistionOrDisposition }})</span>
      </div>
    </td>
  </ng-container>

  <!-- transactionType -->
  <ng-container matColumnDef="transactionType">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden sm:table-cell">Transaction</th>
    <td mat-cell *matCellDef="let row" class="hidden sm:table-cell">
      <ng-container
        *ngTemplateOutlet="transactionTypeDiv; context: { transactionType: row.transactionType }"
      ></ng-container>
    </td>
  </ng-container>

  <!-- price -->
  <ng-container matColumnDef="price">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden lg:table-cell">Price</th>
    <td mat-cell *matCellDef="let row" class="hidden lg:table-cell">
      {{ row.price | currency }}
    </td>
  </ng-container>

  <!-- securitiesTransacted -->
  <ng-container matColumnDef="securitiesTransacted">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden sm:table-cell">Units</th>
    <td mat-cell *matCellDef="let row" class="hidden sm:table-cell">
      {{ row.securitiesTransacted | largeNumberFormatter: false : false }}
    </td>
  </ng-container>

  <!-- total -->
  <ng-container matColumnDef="total">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden sm:table-cell">Total</th>
    <td mat-cell *matCellDef="let row">
      <div class="flex flex-col items-end">
        <span>{{ row.securitiesTransacted * row.price | largeNumberFormatter: false : true }}</span>

        <div class="block sm:hidden">
          <ng-container
            *ngTemplateOutlet="transactionTypeDiv; context: { transactionType: row.transactionType }"
          ></ng-container>
        </div>
      </div>
    </td>
  </ng-container>

  <!-- date -->
  <ng-container matColumnDef="date">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden sm:table-cell">Date</th>
    <td mat-cell *matCellDef="let row" class="hidden sm:table-cell">
      {{ row.transactionDate | date: 'MMMM d, y' }}
    </td>
  </ng-container>

  <!-- redirect -->
  <ng-container matColumnDef="redirect">
    <th mat-header-cell mat-sort-header *matHeaderCellDef class="hidden md:table-cell">Redirect</th>
    <td mat-cell *matCellDef="let row" class="hidden md:table-cell">
      <a mat-icon-button [href]="row.link" target="_blank">
        <mat-icon>open_in_new</mat-icon>
      </a>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns" class="hidden sm:contents"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns; let even = even; let odd = odd"></tr>

  <!-- Row shown when there is no matching data. -->
  <tr class="mat-row" *matNoDataRow>
    <td class="mat-cell" colspan="10">No data has been found</td>
  </tr>
</table>

<!-- pagination -->
<div *ngIf="dataSource.filteredData" class="flex items-center justify-end">
  <mat-paginator
    appBubblePagination
    showFirstLastButtons
    [length]="dataSource.filteredData.length"
    [appCustomLength]="dataSource.filteredData.length"
    [pageSize]="25"
  ></mat-paginator>
</div>

<ng-template #transactionTypeDiv let-transactionType="transactionType">
  <div
    [ngClass]="{
      'text-wt-success': transactionType === 'G-Gift',
      'text-wt-danger': transactionType === 'S-Sale',
      'text-wt-gray-dark': transactionType !== 'G-Gift' && transactionType !== 'S-Sale'
    }"
  >
    {{ transactionType }}
  </div>
</ng-template>
